% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_regions.R
\name{filter_regions}
\alias{filter_regions}
\title{Apply user-defined filtering options to genomic regions.}
\usage{
filter_regions(
  data,
  include_by_chromosome_name = NULL,
  exclude_by_blacklist = NULL,
  include_above_score_cutoff = NULL,
  include_top_n_scoring = NULL,
  show_messages = TRUE
)
}
\arguments{
\item{data}{PeakCombiner data frame structure with required columns
named \code{chrom}, \code{start}, \code{end}, \code{name},
\code{score}, \code{strand}, \code{center}, \code{sample_name}. Additional
columns will be maintained.}

\item{include_by_chromosome_name}{\itemize{
\item 'NULL' (default) - No chromosome name filtering will be done.
* Character vector that contains chromosomes names to be retained.
}}

\item{exclude_by_blacklist}{\itemize{
\item 'NULL' (default) - No blacklist filtering will be done.
* Single value for annotation of provided blacklists ('hg38' or
'mm10'), which uses ENCODE blacklist to filter.
* Data frame or tibble with columns \code{chrom}, \code{start}, and \code{end}.
}}

\item{include_above_score_cutoff}{\itemize{
\item 'NULL' (default) - No score filtering will be done.
* Single numeric value that defines the \code{score} threshold above
which all genomic regions will be retained. This results in
variable number of sites per sample.
}}

\item{include_top_n_scoring}{\itemize{
\item 'NULL' (default) - No score filtering will be done.
* Single numeric value representing the number of genomic regions
per sample to be retained. The genomic regions are selected from
highest to lowest score, and if include_top_n_scoring > number of
regions, then no filtering is done.
}}

\item{show_messages}{Logical value of TRUE (default) or FALSE. Defines if
info messages are displayed or not.}
}
\value{
A tibble with the columns \code{chrom}, \code{start}, \code{end}, \code{name}, \code{score},
\code{strand}, \code{center}, \code{sample_name}. The definitions of these columns are
described in full in the \link{prepare_input_regions} Details.
Use as input for functions \link{center_expand_regions} and
\link{combine_regions}.
}
\description{
\link{filter_regions} is an optional step that allows
inclusion or exclusion of genomic regions based on 4 different criteria:
\itemize{
\item Include regions by their chromosome names (optional).
\item Exclude blacklisted regions (optional).
\item Include regions above a given score (optional).
\item Include top n regions per sample, ranked from highest to lowest score
(optional).
}

The accepted input is the PeakCombiner data frame is created from the
function \link{prepare_input_regions}.
Please see \link{prepare_input_regions} for more details.

The \link{filter_regions} can be used multiple times on the same
data set, which allows a user to step-wise optimize selection criteria of
regions of interest.
}
\details{
This is an optional step which enables commonly-needed filtering steps to
focus in on the key genomic regions of interest. This can be useful
when there are many genomic regions identified in your peak-caller or
input BED files.

\link{filter_regions} can be used multiple times on the same data
set, allowing a user to select regions of interest using a step-wise
optimization approach.
\itemize{
\item \code{include_by_chromosome_name} -   Retains only chromosomes that are in the
provided vector. By not including
mitochondrial, sex, or non-classical
chromosomes, genomic regions found on
these chromosomes can be removed. If set
to 'NULL' (default), this step will be
skipped (optional).
\item \code{exclude_by_blacklist} -         Remove ENCODE-annotated blacklisted
regions for either human (
\href{https://www.encodeproject.org/files/ENCFF356LFX/}{hg38}
only) or mouse (
\href{https://www.encodeproject.org/files/ENCFF547MET/}{mm10}
only). Alternatively, a data frame or
tibble can be provided listing the genomic
regions to remove (having \code{chrom},
\code{start}, and \code{end}  column names). If set
to 'NULL' (default), this step will be
skipped (optional).
Please note that if there are not matching
entries in the 'chrom' columns of input
and blacklist, an information message is
displayed. This can happend und does not
cause any problems with the script.
\item \code{include_above_score_cutoff} -   Single numeric value that defines the
\code{score} threshold above which all genomic
regions will be retained. The \code{score}
column in the peakCombiner input data
should be non-zero for this parameter to
be used. It is populated by
\link{prepare_input_regions}, and
by default takes the value of -log10(FDR)
if possible (e.g., using a .narrowPeak
file from MACS2 as input). Importantly,
applying this filter retains a variable
number of genomic regions per sample, all
having a score greater than the
\code{include_above_score_cutoff} parameter. If
set to 'NULL' (default), this step will
be skipped (optional).
\item \code{include_top_n_scoring} -        Single numeric value that defines how many
of the top scoring genomic regions (using
the column \code{score}) are retained. All
other genomic regions are discarded.
Importantly, applying this filter retains
\code{include_top_n_scoring} regions per
sample, which means that the minimum
enrichment levels may vary between
samples. Note that if multiple genomic
regions have the same \code{score} cutoff
value, then all of those genomic regions
are included. In this case, the number of
resulting regions retained may be a bit
higher than the input parameter. If set to
'NULL' (default), this step will be
skipped (optional).
}
}
\examples{

#Load in and prepare a an accepted tibble
input_data <- peakCombiner::syn_data_bed
input_data

data_prepared <- prepare_input_regions(
  data = input_data,
  show_messages = TRUE
)

# Here use options for all four filtering methods.

filter_regions(
  data = data_prepared,
  include_by_chromosome_name = c("chr1", "chr2", "chr4"),
  exclude_by_blacklist = "hg38",
  include_above_score_cutoff = 10,
  include_top_n_scoring = 100,
  show_messages = TRUE
)

}
