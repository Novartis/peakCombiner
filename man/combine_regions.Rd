% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/combine_regions.R
\name{combine_regions}
\alias{combine_regions}
\title{Combine overlapping genomic regions from different samples to create
a single set of consensus genomic regions}
\usage{
combine_regions(
  data,
  found_in_samples = 2,
  combined_center = "nearest",
  annotate_with_input_names = FALSE,
  combined_sample_name = NULL,
  show_messages = TRUE
)
}
\arguments{
\item{data}{PeakCombiner data frame structure with required columns
named \code{chrom}, \code{start}, \code{end}, \code{name},
\code{score}, \code{strand}, \code{center}, \code{sample_name}. Additional
columns will be dropped}

\item{found_in_samples}{Only include genomic regions that are found
in at least \code{found_in_samples} \strong{number}
of samples. If \code{found_in_samples} is a fraction
between 0 and 1, then only include genomic
regions that ar found in at least
\code{found_in_samples} \strong{fraction} of samples.
Default value is 2.}

\item{combined_center}{Defines how the column 'center' will be
populated for each genomic region in the output
data. Allowed options are
* \code{middle}        - the mathematical center of the new region
* \code{strongest}     - the 'center' of the input region that has the
the highest 'score' of all overlapping input
regions
* \code{nearest}       - the 'center' of the input region that is closest
to mean of the 'center's of all overlapping
input regions (default)}

\item{annotate_with_input_names}{TRUE / FALSE (default). If TRUE, a new
column named 'input_names' is created
in the output data that is populated for
each combined genomic region with the
'name's of all contributing input regions.
If the column 'input_names' already
exists, it will be overwritten.}

\item{combined_sample_name}{Optionally defines how the column 'sample_name'
is populated for the output data.
If not used, then the default is to simply
concatenate all input
sample_names into a single comma-separated
string}

\item{show_messages}{Logical value of TRUE (default) or FALSE. Defines if
info messages are displayed or not.}
}
\value{
A tibble with the columns \code{chrom}, \code{start}, \code{end}, \code{name}, \code{score},
\code{strand}, \code{center}, \code{sample_name}, and optionally \code{input_names}.
The definitions of these columns are
described in full in the Details below. Use as input for functions
\link{center_expand_regions} and \link{filter_regions}.
}
\description{
\link{combine_regions} is the main function of this package and
combines overlapping genomic regions from different samples to create
a single set of consensus genomic regions.

The accepted input is the PeakCombiner data frame is created from the
function \link{prepare_input_regions} and has optionally
already been centered and expanded and / or filtered using
\link{center_expand_regions} and \link{filter_regions},
respectively.
Please see \link{prepare_input_regions} for more details.
}
\details{
\link{combine_regions} creates a set of consensus genomic regions by
combining overlapping genomic regions from different samples.
The general steps within this function are:
\itemize{
\item Identify overlapping genomic regions from the input samples
\item Retain overlapping genomic regions that are found in at least
\code{found_in_samples} samples. In this way, you can remove rare or
sample-specific regions
\item Note that overlapping genomic regions must contain at least one 'center'
from its input sample regions to be considered a valid genomic region.
\item As you can use the output data from this step again (e.g., to
center and expand the new set of consensus regions), we must define
the 'center', 'score', 'sample_name', and 'name' values for the new
genomic regions. We do this as follows:
\itemize{
\item 'center' is defined by the \code{combined_center} parameter, which has three
options.
* \code{middle}        - the mathematical center of the new region
* \code{strongest}     - the 'center' of the input region that has the
the highest 'score' of all overlapping input
regions
* \code{nearest}       - the 'center' of the input region that is closest
to mean of the 'center's of all overlapping
input regions (default)
\item 'score' is the score of the genomic region from the sample whose
'center's was used, or the mean of the 'score's if \code{middle} was selected
for the \code{combined_center} parameter
\item 'sample_name' can be user defined (\code{combined_sample_name}) or is a
concatenated string of all input 'sample_names' (default).
\item 'name' is created by combining 'sample_name' and row number to create a
unique identifier for each newly created genomic region.
}
}

Note, the output data.frame columns \code{sample_name}, \code{name} and \code{score}
will be updated.
}
\examples{
# Load in and prepare a an accepted tibble
utils::data(syn_data_bed)

data_prepared <- prepare_input_regions(
  data = syn_data_bed,
  show_messages = FALSE
)

# Lets combine the input data by defining all potential option
combine_regions(
  data = data_prepared,
  found_in_samples = 2,
  combined_center = "nearest",
  annotate_with_input_names = TRUE,
  combined_sample_name = "consensus",
  show_messages = TRUE
)

}
